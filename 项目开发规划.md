# AlbumClean 项目开发规划

## 项目概述

AlbumClean 是一个面向 Android 用户的相册管理应用，旨在帮助用户高效整理和清理手机中的照片和视频文件。通过智能分组和沉浸式预览功能，用户可以快速决定保留或删除照片。

## 技术架构设计

### 1. 整体架构模式

采用 MVVM (Model-View-ViewModel) 架构模式，结合 Repository 模式进行数据管理：

```
┌─────────────┐    ┌──────────────────┐    ┌──────────────┐
│   Screen    │────▶   ViewModel     │────▶   Repository  │
└─────────────┘    └──────────────────┘    └──────────────┘
                            │                       │
                            ▼                       ▼
                    ┌──────────────┐      ┌─────────────────┐
                    │   State      │      │   Data Source   │
                    └──────────────┘      └─────────────────┘
```

### 2. 主要模块划分

#### 2.1 数据层 (Data Layer)

- **MediaRepository**: 媒体文件获取和管理
- **UserPreferencesRepository**: 用户偏好设置管理
- **GroupRepository**: 照片分组管理
- **Database**: Room 数据库用于本地数据存储

#### 2.2 业务逻辑层 (Domain Layer)

- **Use Cases**:
  - GetAllMediaUseCase: 获取所有媒体文件
  - CreateGroupsUseCase: 创建照片分组
  - UpdateMediaStatusUseCase: 更新媒体文件状态
  - GetUserPreferencesUseCase: 获取用户偏好设置

#### 2.3 表示层 (Presentation Layer)

- **UI Components**:
  - HomeScreen: 首页缩略图展示
  - MyScreen: "我的"页面
  - PreviewScreen: 照片预览处理页
  - ConfirmationScreen: 确认删除页
  - TutorialScreen: 功能引导教程页
- **ViewModels**:
  - HomeViewModel
  - MyViewModel
  - PreviewViewModel
  - ConfirmationViewModel

### 3. 核心技术栈

#### 3.1 语言和框架

- Kotlin 作为主要开发语言
- Jetpack Compose 用于构建现代化 UI
- Android Architecture Components (ViewModel, LiveData, Room)

#### 3.2 第三方库

- Coil: 图片加载和缓存
- Room: 本地数据库
- DataStore: 用户偏好设置存储
- Accompanist: 补充 Compose 功能组件

#### 3.3 数据存储

- Room Database: 存储媒体索引和用户操作记录
- DataStore: 存储用户偏好设置
- SharedPreferences: 备用简单数据存储

## 功能模块详细设计

### 1. 首页 (HomeScreen)

- 首次使用引导用户建立数据库分组
- 显示开始清理按钮
- 展示最近处理的分组

### 2. 我的页面 (MyScreen)

- 用户信息展示区域（默认昵称和头像）
- 设置选项：
  - 深色/浅色模式切换
  - 自定义主题色选择
  - 单组照片数量设置（多选一滑动组件）
  - 相册数据库重建（每次启动分组时，自动排查并重建数据库）
  - 关于页面链接
  - 隐私政策链接
  - 开源许可协议
  - 贡献者名单
  - 联网开关
  - SSO 开源库信息

### 3. 照片预览处理页 (PreviewScreen)

- 沉浸式全屏展示照片
- 居中显示并添加样式美化
- 手势识别：
  - 上滑：保留照片并预览下一张
  - 下滑：删除照片并预览下一张
- 底部显示进度指示器

### 4. 确认删除页 (ConfirmationScreen)

- 分开展示已删除和保留的照片缩略图
- 底部操作按钮：
  - 确认删除（红色标注）
  - 再过一遍
  - 取消

### 5. 功能引导教程页 (TutorialScreen)

- 新手引导流程
- 功能介绍和操作演示
- 内置一组 10 张照片引导用户浏览和选择走完流程
- 教程开始时建立相册数据库，并说明“不给予数据库权限可以体验内置示例照片”

## 数据库设计

### 1. MediaEntity 表

```
- id: Long (主键)
- uri: String (文件URI)
- displayName: String (显示名称)
- mimeType: String (媒体类型)
- size: Long (文件大小)
- dateAdded: Long (添加日期)
- dateModified: Long (修改日期)
- status: Int (状态：保留/删除/未处理)
- groupId: Long (所属分组ID)
```

### 2. GroupEntity 表

```
- id: Long (主键)
- name: String (分组名称)
- createdTime: Long (创建时间)
- completedTime: Long? (完成时间)
- status: Int (状态：进行中/已完成)
```

### 3. UserPreference 表

```
- key: String (主键)
- value: String (配置值)
```

## 开发计划

### 第一阶段：基础框架搭建 (1-2 周)

- [ ] 项目结构初始化
- [ ] 添加必要依赖库
- [ ] 实现基础导航架构
- [ ] 创建 Room 数据库和数据模型
- [ ] 实现媒体文件扫描功能

### 第二阶段：核心功能开发 (3-5 周)

- [ ] 实现首页缩略图展示
- [ ] 开发照片分组功能
- [ ] 实现沉浸式预览页面
- [ ] 添加手势操作功能
- [ ] 开发确认删除页面

### 第三阶段：个性化设置和辅助功能 (6-7 周)

- [ ] 实现"我的"页面
- [ ] 添加深色/浅色模式切换
- [ ] 实现主题色自定义功能
- [ ] 添加单组照片数量设置
- [ ] 开发功能引导教程页

### 第四阶段：测试和优化 (8 周)

- [ ] 功能测试和 Bug 修复
- [ ] 性能优化
- [ ] UI/UX 优化
- [ ] 编写单元测试
- [ ] 准备发布版本

## 作者信息

- 作者昵称：sikuai
- 联系方式：2643927725#qq.com
